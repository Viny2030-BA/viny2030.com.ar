function doPost(e) {
  const sheet = SpreadsheetApp.openById('1HRClhTtJO-vVpUoheTxlnY2CvOhNXKqw73HdnNqURtM').getSheets()[0];
  const data = JSON.parse(e.postData.contents);
  
  sheet.appendRow([
    new Date(),
    data.nombre,
    data.apellido,
    data.email,
    data.pais,
    data.telefono,
    data.empresa,
    data.intencion,
    data.firmaNombre,
    data.firmaApellido,
    data.fecha,
    data.idioma
  ]);

  MailApp.sendEmail({
    to: 'viny01958@gmail.com',
    subject: 'ðŸ”” Nuevo registro VNY - ' + data.nombre + ' ' + data.apellido,
    body: `
NUEVO REGISTRO VINY2030
=======================
Nombre: ${data.nombre} ${data.apellido}
Email: ${data.email}
PaÃ­s: ${data.pais}
TelÃ©fono: ${data.telefono}
Empresa: ${data.empresa}
IntenciÃ³n: ${data.intencion}
Idioma: ${data.idioma}
Firma: ${data.firmaNombre} ${data.firmaApellido}
Fecha: ${data.fecha}
=======================
    `
  });

  return ContentService.createTextOutput(JSON.stringify({status: 'ok'}))
    .setMimeType(ContentService.MimeType.JSON);
}
function testEmail() {
  MailApp.sendEmail({
    to: 'viny01958@gmail.com',
    subject: 'ðŸ”” TEST - Viny2030',
    body: 'Prueba de email desde Apps Script funcionando correctamente.'
  });
}
